<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="description"
      content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular."
    />
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:site" content="@pratikborsadiya" />
    <meta property="twitter:creator" content="@pratikborsadiya" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Vali Admin" />
    <meta property="og:title" content="Vali - Free Bootstrap 5 admin theme" />
    <meta
      property="og:url"
      content="http://pratikborsadiya.in/blog/vali-admin"
    />
    <meta
      property="og:image"
      content="http://pratikborsadiya.in/blog/vali-admin/hero-social.png"
    />
    <meta
      property="og:description"
      content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular."
    />
    <title>VetAdmin - Sistema de Gestión</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <link href="datatables/datatables.min.css" rel="stylesheet" />
    <style>
      .remove-product-btn {
        cursor: pointer;
        color: red;
      }
      .remove-product-btn:hover {
        color: darkred;
      }
    </style>
  </head>
  <body class="app sidebar-mini">
    <header class="app-header">
      <a class="app-header__logo" href="index.html">VetAdmin</a>
      <a
        class="app-sidebar__toggle"
        href="#"
        data-toggle="sidebar"
        aria-label="Hide Sidebar"
      ></a>
      <ul class="app-nav">
        <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search" />
          <button class="app-search__button">
            <i class="bi bi-search"></i>
          </button>
        </li>
        <li class="dropdown">
          <a
            class="app-nav__item"
            href="#"
            data-bs-toggle="dropdown"
            aria-label="Show notifications"
            ><i class="bi bi-bell fs-5"></i
          ></a>
          <ul class="app-notification dropdown-menu dropdown-menu-right">
            <li class="app-notification__title">
              Tienes 4 notificaciones nuevas.
            </li>
            <div class="app-notification__content">
              <li>
                <a class="app-notification__item" href="javascript:;"
                  ><span class="app-notification__icon"
                    ><i class="bi bi-envelope fs-4 text-primary"></i
                  ></span>
                  <div>
                    <p class="app-notification__message">
                      Lisa te envio un correo
                    </p>
                    <p class="app-notification__meta">2 min ago</p>
                  </div></a
                >
              </li>
              <li>
                <a class="app-notification__item" href="javascript:;"
                  ><span class="app-notification__icon"
                    ><i class="bi bi-envelope fs-4 text-primary"></i
                  ></span>
                  <div>
                    <p class="app-notification__message">
                      Lisa te envio un correo
                    </p>
                    <p class="app-notification__meta">2 min ago</p>
                  </div></a
                >
              </li>
            </div>
            <li class="app-notification__footer">
              <a>Notificaciones</a>
            </li>
          </ul>
        </li>
        <li class="dropdown">
          <a
            class="app-nav__item"
            href="#"
            data-bs-toggle="dropdown"
            aria-label="Open Profile Menu"
            ><i class="bi bi-person fs-4"></i
          ></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li>
              <a class="dropdown-item" href="page-user.html"
                ><i class="bi bi-person me-2 fs-5"></i> Profile</a
              >
            </li>
            <li>
              <a class="dropdown-item" href="page-login.html"
                ><i class="bi bi-box-arrow-right me-2 fs-5"></i> Logout</a
              >
            </li>
          </ul>
        </li>
      </ul>
    </header>
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
      <div class="app-sidebar__user">
        <img
          class="app-sidebar__user-avatar"
          src="images/user.png"
          alt="User Image"
        />
        <div>
          <p class="app-sidebar__user-name">Francisco Aquino</p>
          <p class="app-sidebar__user-designation">Developer</p>
        </div>
      </div>
      <ul class="app-menu">
        <li>
          <a class="app-menu__item" href="dashboard.html"
            ><i class="app-menu__icon bi bi-speedometer"></i
            ><span class="app-menu__label">Dashboard</span></a
          >
        </li>
        <li class="treeview">
          <a class="app-menu__item" href="#" data-toggle="treeview"
            ><i class="app-menu__icon bi bi-laptop"></i
            ><span class="app-menu__label">Personas</span
            ><i class="treeview-indicator bi bi-chevron-right"></i
          ></a>
          <ul class="treeview-menu">
            <li>
              <a class="treeview-item" href="usuarios.html"
                ><i class="icon bi bi-circle-fill"></i> Usuario</a
              >
            </li>
            <li>
              <a class="treeview-item" href="colaborador.html"
                ><i class="icon bi bi-circle-fill"></i> Colaborador</a
              >
            </li>
          </ul>
        </li>
        <li class="treeview">
          <a class="app-menu__item" href="#" data-toggle="treeview"
            ><i class="app-menu__icon bi bi-laptop"></i
            ><span class="app-menu__label">Clientes y Mascotas</span
            ><i class="treeview-indicator bi bi-chevron-right"></i
          ></a>
          <ul class="treeview-menu">
            <li>
              <a class="treeview-item" href="cliente.html"
                ><i class="icon bi bi-circle-fill"></i> Clientes</a
              >
            </li>
            <li>
              <a class="treeview-item" href="mascota.html"
                ><i class="icon bi bi-circle-fill"></i> Mascotas</a
              >
            </li>
          </ul>
        </li>
        <li class="treeview">
          <a class="app-menu__item" href="#" data-toggle="treeview"
            ><i class="app-menu__icon bi bi-laptop"></i
            ><span class="app-menu__label">Productos y Categoria</span
            ><i class="treeview-indicator bi bi-chevron-right"></i
          ></a>
          <ul class="treeview-menu">
            <li>
              <a class="treeview-item" href="categoria.html"
                ><i class="icon bi bi-circle-fill"></i> Categoria</a
              >
            </li>
            <li>
              <a class="treeview-item" href="/listar_producto"
                ><i class="icon bi bi-circle-fill"></i> Productos</a
              >
            </li>
          </ul>
        </li>
        <li class="treeview">
          <a class="app-menu__item" href="#" data-toggle="treeview"
            ><i class="app-menu__icon bi bi-laptop"></i
            ><span class="app-menu__label">Reservas</span
            ><i class="treeview-indicator bi bi-chevron-right"></i
          ></a>
          <ul class="treeview-menu">
            <li>
              <a class="treeview-item" href="servicio.html"
                ><i class="icon bi bi-circle-fill"></i> Servicio</a
              >
            </li>
            <li>
              <a class="treeview-item" href="cita.html"
                ><i class="icon bi bi-circle-fill"></i> Cita</a
              >
            </li>
            <li>
              <a class="treeview-item" href="reserva.html"
                ><i class="icon bi bi-circle-fill"></i> Estado Reservas</a
              >
            </li>
          </ul>
        </li>
        <li class="treeview">
          <a class="app-menu__item" href="#" data-toggle="treeview"
            ><i class="app-menu__icon bi bi-laptop"></i
            ><span class="app-menu__label">Ventas</span
            ><i class="treeview-indicator bi bi-chevron-right"></i
          ></a>
          <ul class="treeview-menu">
            <li>
              <a class="treeview-item" href="venta.html"
                ><i class="icon bi bi-circle-fill"></i> Ventas</a
              >
            </li>
            <li>
              <a class="treeview-item" href="detalle.html"
                ><i class="icon bi bi-circle-fill"></i> Detalle</a
              >
            </li>
          </ul>
        </li>
      </ul>
    </aside>
    <main class="app-content">
      <div class="app-title">
        <div>
          <h1><i class="bi bi-ui-checks"></i> Formulario Detalle de Venta</h1>
          <p>Registro de Detalle de Venta</p>
        </div>
        <ul class="app-breadcrumb breadcrumb">
          <li class="breadcrumb-item"><i class="bi bi-house-door fs-6"></i></li>
          <li class="breadcrumb-item">Forms</li>
          <li class="breadcrumb-item"><a href="venta.html">Venta</a></li>
        </ul>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="tile">
            <h3 class="tile-title">Agregar Producto</h3>
            <div class="tile-body">
              <div class="form-group">
                <label for="codigo_producto">Código de Producto</label>
                <input
                  type="text"
                  class="form-control"
                  id="codigo_producto"
                  name="codigo_producto"
                  required
                />
              </div>
              <div class="form-group">
                <label for="cantidad">Cantidad</label>
                <input
                  type="number"
                  class="form-control"
                  id="cantidad"
                  name="cantidad"
                  min="1"
                  value="1"
                  required
                />
              </div>
              <div class="form-group">
                <label for="precio_unitario">Precio Unitario</label>
                <input
                  type="number"
                  class="form-control"
                  id="precio_unitario"
                  name="precio_unitario"
                  min="0.01"
                  step="0.01"
                  required
                />
              </div>
              <br />
              <button
                class="btn btn-primary"
                id="btn-agregar-producto"
                type="button"
              >
                <i class="bi bi-plus-circle-fill me-2"></i>Agregar Producto
              </button>
            </div>
          </div>
          <div class="tile">
            <h3 class="tile-title">Detalle de Venta</h3>
            <div class="tile-body">
              <form id="form-registrar-venta" action="#" method="POST">
                <table class="table table-bordered" id="tabla-detalle-venta">
                  <thead>
                    <tr>
                      <th>Código Producto</th>
                      <th>Cantidad</th>
                      <th>Precio Unitario</th>
                      <th>Subtotal</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Aquí se agregan dinámicamente las filas -->
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="3" align="right"><strong>Total</strong></td>
                      <td><strong id="total">0.00</strong></td>
                      <td></td>
                    </tr>
                  </tfoot>
                </table>
                <button type="submit" class="btn btn-success">
                  <i class="bi bi-check-circle-fill me-2"></i>Registrar Venta
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script src="js/jquery-3.7.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <script>
      $(document).ready(function () {
        var contadorFilas = 0;
        var totalVenta = 0;

        $("#btn-agregar-producto").click(function () {
          var codigoProducto = $("#codigo_producto").val();
          var cantidad = parseInt($("#cantidad").val());
          var precioUnitario = parseFloat($("#precio_unitario").val()).toFixed(
            2
          );
          var subtotal = (cantidad * precioUnitario).toFixed(2);

          var fila = '<tr id="fila-' + contadorFilas + '">';
          fila += "<td>" + codigoProducto + "</td>";
          fila += "<td>" + cantidad + "</td>";
          fila += "<td>" + precioUnitario + "</td>";
          fila += '<td class="subtotal">' + subtotal + "</td>";
          fila +=
            '<td><button type="button" class="btn btn-sm btn-danger btn-remove-product" data-id="' +
            contadorFilas +
            '"><i class="bi bi-trash-fill"></i></button></td>';
          fila += "</tr>";

          $("#tabla-detalle-venta tbody").append(fila);

          totalVenta += parseFloat(subtotal);
          $("#total").text(totalVenta.toFixed(2));

          contadorFilas++;

          // Limpiar campos después de agregar producto
          $("#codigo_producto").val("");
          $("#cantidad").val("1");
          $("#precio_unitario").val("");
        });

        // Eliminar producto del detalle de venta
        $(document).on("click", ".btn-remove-product", function () {
          var idFila = $(this).data("id");
          var subtotal = parseFloat($("#fila-" + idFila + " .subtotal").text());

          $("#fila-" + idFila).remove();

          totalVenta -= subtotal;
          $("#total").text(totalVenta.toFixed(2));
        });

        // Enviar formulario con los datos de la tabla dinámica
        $("#form-registrar-venta").submit(function (event) {
          event.preventDefault();

          // Aquí puedes enviar los datos al servidor o procesarlos como necesites
          alert("Datos enviados correctamente.");

          // Limpia la tabla y resetea el total después de enviar
          $("#tabla-detalle-venta tbody").empty();
          $("#total").text("0.00");
          totalVenta = 0;
          contadorFilas = 0;
        });
      });
    </script>
  </body>
</html>
